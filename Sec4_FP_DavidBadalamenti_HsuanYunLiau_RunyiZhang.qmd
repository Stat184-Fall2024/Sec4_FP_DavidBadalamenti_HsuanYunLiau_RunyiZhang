---
title: "SSec4_FP_DavidBadalamenti_HsuanYunLiau_RunyiZhang"
format: pdf
editor: visual
---

# Exploring factors influencing the pricing of used cars

## Data: Auto Scout Car

The buying ans selling of vehicles form a critical part of economies worldwide, with online marketplaces playing an increasingly important role in connecting buyers and sellers. Auto Scout, the largest pan-European online car marketplace, provides an extensive dataset detailing used car listings, including specifications, features, and prices. These details offer a valuable opportunity to investigate a pressing question in the automotive market: *What factors significantly influence the pricing of used cars?* In this report, we will explore how age and mileage of a vehicle affect the price and find which has a more significant impact.

## **Explain how your data meet the FAIR and/or CARE Principles:**

**FAIR:**

-   Findable:

    -   dataset found through kaggle, which is a widely recognized and accessible platform for data sharing

    -   includes metadata that describes the dataset structure and its variables, which helps users locate and understand relevant information

-   Accessible:

    -   the dataset is provided in a CSV format

    -   the platform has open access to dataset

-   Interoperable:

    -   the data uses standard and machine readable formats, such as numeric fields for prices and mileage and categorical fields for attributes like fuel type and body type

    -   the metadata provides clear descriptions of fields

Reusable:

-   the data is accompanied by metadata that ensures the attributes, ensuring clarity for reuse

**CARE:**

-   **Collective benefit**:

The dataset enables analyses that can benefit a wide audience, such as consumers, dealers, and researchers

-   **Authority to control**:

    -   the data contains public information on car listings and does not include personal or community-sensitive data

-   **Responsibility:**

    -   the dataset avoids ethical issues by not including personal identifiers or private information

-   **Ethics:**

    -   By excluding sensitive information, the dataset aligns with ethical principles for data usage.

    -   The source (Kaggle) provides transparency about the dataset's origin, licensing, and usage conditions

## Distribution of car models:

To begin with, we generated a histogram visualizing the frequency distribution of car models in the dataset, with the make_model variable on the x-axis and the count of listings on the y-axis. By identifying the models with the highest frequency, we can focus on the top three most common car models for further analysis, which in this case, the Audi A3, Audi A1, and Opel Insignia.

```{r}
<<<<<<< HEAD
library(readr)
library(dplyr)
data <- read.csv("final_scout_not_dummy.csv")
=======
library(tidyverse)

data <- read.csv("cleaned_scout_data.csv")

model_counts <- data %>% 
  group_by(make_model) %>% 
  summarise(count = n()) %>% 
  arrange(desc(count))

top_3_models <- head(model_counts, 3)

library(ggplot2)
ggplot(data, aes(x = make_model, fill = make_model)) +
  geom_bar(color = "black") +
  geom_text(data = top_3_models, aes(x = make_model, y = count, label = count), 
            vjust = -0.5, color = "black", size = 3) +
  labs(
    title = "Histogram of All Car Models",
    x = "Car Model",
    y = "Count"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
>>>>>>> 2d145591dcc75f145eb44be60b98e93728a889b7

```

Choosing larger sample size for these models ensures the results are statistically reliable and can help better evaluate how variables like mileage and age impact the prices within and across top models. By finding the regressions coefficient for both age and mileage we can see which has a larger impact on the price of the car.

** Age models ** 
The following are the graphs of the age vs price for the three different car models

```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
 audi_a3_data <- data %>% filter(make_model == "Audi A3")

# Scatter plot with regression line
#ggplot(audi_a3_data, aes(x = age, y = price)) +
  #geom_point(alpha = 0.6) +
  #geom_smooth(method = "lm", se = TRUE, color = "red") +
  #labs(
    #title = "Price vs Age for Audi A3",
    #x = "Age (years)",
    #y = "Price (in units)"
  #) +
  #theme_minimal()
#audi_age_model <- lm(price ~ age, data = audi_a3_data)
#summary(audi_age_model)


# Boxplot
ggplot(audi_a3_data, aes(x = factor(age), y = price)) +
  geom_boxplot(fill = "pink") +
  labs(
    title = "Boxplot of Price by Age for Audi A3",
    x = "Age (years)",
    y = "Price (in units)"
  ) +
  theme_minimal()

opel_insignia_data <- data %>% filter(make_model == "Opel Insignia")

# Scatter plot with regression line
# ggplot(opel_insignia_data, aes(x = age, y = price)) +
#   geom_point(alpha = 0.6) +
#   geom_smooth(method = "lm", se = TRUE, color = "blue") +
#   labs(
#     title = "Price vs Age for Opel Insignia",
#     x = "Age (years)",
#     y = "Price (in units)"
#   ) +
#   theme_minimal()
# 
# opel_age_model <- lm(price ~ age, data = opel_insignia_data)
# summary(opel_age_model)

# Boxplot
ggplot(opel_insignia_data, aes(x = factor(age), y = price)) +
  geom_boxplot(fill = "lightblue") +
  labs(
    title = "Boxplot of Price by Age for Opel Insignia",
    x = "Age (years)",
    y = "Price (in units)"
  ) +
  theme_minimal()
audi_a1_data <- data %>% filter(make_model == "Audi A1")

# Scatter plot with regression line
# ggplot(audi_a1_data, aes(x = age, y = price)) +
#   geom_point(alpha = 0.6) +
#   geom_smooth(method = "lm", se = TRUE, color = "green") +
#   labs(
#     title = "Price vs Age for Audi A1",
#     x = "Age (years)",
#     y = "Price (in units)"
#   ) +
#   theme_minimal()
# 
# audi1_age_model <- lm(price ~ age, data = audi_a1_data)
# summary(audi1_age_model)

# Boxplot for price by age for Audi A1
ggplot(audi_a1_data, aes(x = factor(age), y = price)) +
  geom_boxplot(fill = "lightgreen") +
  labs(
    title = "Boxplot of Price by Age for Audi A1",
    x = "Age (years)",
    y = "Price (in units)"
  ) +
  theme_minimal()
      
```
      
After Visualizing the data with a box plot we create a scatter plot with a regression line to see the change in price by age
```{r codeAppend, ref.label=knitr::all_labels(), echo=TRUE, eval=FALSE}
 audi_a3_data <- data %>% filter(make_model == "Audi A3")

# Scatter plot with regression line
ggplot(audi_a3_data, aes(x = age, y = price)) +
geom_point(alpha = 0.6) +
geom_smooth(method = "lm", se = TRUE, color = "red") +
labs(
title = "Price vs Age for Audi A3",
x = "Age (years)",
y = "Price (in units)"
) +
theme_minimal()

# audi_age_model <- lm(price ~ age, data = audi_a3_data)
# summary(audi_age_model)
# 

# Boxplot
# ggplot(audi_a3_data, aes(x = factor(age), y = price)) +
#   geom_boxplot(fill = "pink") +
#   labs(
#     title = "Boxplot of Price by Age for Audi A3",
#     x = "Age (years)",
#     y = "Price (in units)"
#   ) +
#   theme_minimal()

opel_insignia_data <- data %>% filter(make_model == "Opel Insignia")

# Scatter plot with regression line
ggplot(opel_insignia_data, aes(x = age, y = price)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, color = "blue") +
  labs(
    title = "Price vs Age for Opel Insignia",
    x = "Age (years)",
    y = "Price (in units)"
  ) +
  theme_minimal()

# opel_age_model <- lm(price ~ age, data = opel_insignia_data)
# summary(opel_age_model)

# Boxplot
# ggplot(opel_insignia_data, aes(x = factor(age), y = price)) +
#   geom_boxplot(fill = "lightblue") +
#   labs(
#     title = "Boxplot of Price by Age for Opel Insignia",
#     x = "Age (years)",
#     y = "Price (in units)"
#   ) +
#   theme_minimal()
# audi_a1_data <- data %>% filter(make_model == "Audi A1")

# Scatter plot with regression line
ggplot(audi_a1_data, aes(x = age, y = price)) +
  geom_point(alpha = 0.6) +
  geom_smooth(method = "lm", se = TRUE, color = "green") +
  labs(
    title = "Price vs Age for Audi A1",
    x = "Age (years)",
    y = "Price (in units)"
  ) +
  theme_minimal()

# audi1_age_model <- lm(price ~ age, data = audi_a1_data)
# summary(audi1_age_model)

# Boxplot for price by age for Audi A1
# ggplot(audi_a1_data, aes(x = factor(age), y = price)) +
#   geom_boxplot(fill = "lightgreen") +
#   labs(
#     title = "Boxplot of Price by Age for Audi A1",
#     x = "Age (years)",
#     y = "Price (in units)"
#   ) +
#   theme_minimal()
#       
```
As expected the age has a large affect on the price of the car decreasing over time we then take the regression line and find the regression coefficient to determine the amount the price changes per year per model of car

